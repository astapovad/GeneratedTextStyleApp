import streamlit as st
from openai import OpenAI

client = OpenAI(api_key=st.secrets["openai_api_key"])

st.title("–°—Ç–∏–ª—å–æ–≤–∏–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ç–µ–∫—Å—Ç—É")

st.write("""
–í—ñ—Ç–∞—é! üí´ 
–Ø - –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä, —è–∫–∏–π –¥–æ–ø–æ–º–æ–∂–µ –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –≤–∞–º —Ç–µ–∫—Å—Ç –∑–∞ –æ–±—Ä–∞–Ω–∏–º —Å—Ç–∏–ª–µ–º! 
___________________________

1. –û–±–µ—Ä—ñ—Ç—å —Å—Ç–∏–ª—å —Ç–µ–∫—Å—Ç—É, —è–∫–∏–π –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–∏–π
2. –ù–∞–ø–∏—à—ñ—Ç—å –∑–∞–ø–∏—Ç —É —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–µ –ø–æ–ª–µ
3. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "–ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏"
4. –ì–æ—Ç–æ–≤–æ!
___________________________

–í–∏ –æ—Ç—Ä–∏–º–∞—î—Ç–µ –≥—Ä–∞–º–∞—Ç–∏—á–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ç–∞ —Å—Ç–∏–ª—å–æ–≤–æ –∞–¥–∞–ø—Ç–æ–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é –º–æ–≤–æ—é ü©∑
–¢–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –∑–±–µ—Ä–µ–≥—Ç–∏ —Ç–µ–∫—Å—Ç —É —Ñ–æ—Ä–º–∞—Ç—ñ .txt

–ê–≤—Ç–æ—Ä: –ê—Å—Ç–∞–ø–æ–≤–∞ –î–∞—Ä'—è
""")

style = st.selectbox(
    "–û–±–µ—Ä—ñ—Ç—å —Å—Ç–∏–ª—å —Ç–µ–∫—Å—Ç—É:",
    ["–û—Ñ—ñ—Ü—ñ–π–Ω–∏–π", "–ö—Ä–µ–∞—Ç–∏–≤–Ω–∏–π", "–ù–∞—É–∫–æ–≤–∏–π", "–ê–∫–∞–¥–µ–º—ñ—á–Ω–∏–π", "–§–æ—Ä–º–∞–ª—å–Ω–∏–π", "–ú–æ—Ç–∏–≤–∞—Ü—ñ–π–Ω–∏–π", "–†–æ–∑–ø–æ–≤—ñ–¥—å"],
    key="style_select"
)

prompt_styles = {
    "–û—Ñ—ñ—Ü—ñ–π–Ω–∏–π": "–°—Ç–≤–æ—Ä–∏ —Ç–µ–∫—Å—Ç —É —Ñ–æ—Ä–º–∞–ª—å–Ω–æ–º—É, –æ—Ñ—ñ—Ü—ñ–π–Ω–æ–º—É —á–∏ –æ—Ñ—ñ—Ü—ñ–π–Ω–æ-–¥—ñ–ª–æ–≤–æ–º—É —Å—Ç–∏–ª—ñ:",
    "–ö—Ä–µ–∞—Ç–∏–≤–Ω–∏–π": "–°—Ç–≤–æ—Ä–∏ —Ç–µ–∫—Å—Ç —É —Ñ–æ—Ä–º–∞—Ç—ñ –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ä–µ–∫–ª–∞–º–Ω–∏—Ö –±–∞–Ω–µ—Ä—ñ–≤, —Å—Ç–æ—Ä—ñ—Ç–µ–ª—ñ–Ω–≥—É, –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü—ñ–π, –Ω–µ–π–º—ñ–Ω–≥—É, –ø—ñ–¥–ø–∏—Å—ñ–≤ –¥–ª—è —Å–æ—Ü–º–µ—Ä–µ–∂ —ñ –∑–∞–∫–∞–¥—Ä–æ–≤–∏—Ö —Ç–µ–∫—Å—Ç—ñ–≤ –≤—ñ—Ä—É—Å–Ω–∏—Ö —Ä–æ–ª–∏–∫—ñ–≤. –¶–µ –º–æ–∂—É—Ç—å –±—É—Ç–∏ —Ç–∞–∫–æ–∂ –º–∞–ª–µ–Ω—å–∫—ñ —Å–ª–æ–≥–∞–Ω–∏:",
    "–ù–∞—É–∫–æ–≤–∏–π": "–°—Ç–≤–æ—Ä–∏ —Ç–µ–∫—Å—Ç —É –Ω–∞—É–∫–æ–≤–æ–º—É —Å—Ç–∏–ª—ñ: —Ñ–æ—Ä–º–∞–ª—å–Ω–∏–π, –æ–±‚Äô—î–∫—Ç–∏–≤–Ω–∏–π, –∑ —Ç–æ—á–Ω–∏–º–∏ —Ñ–æ—Ä–º—É–ª—é–≤–∞–Ω–Ω—è–º–∏, –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ—é –ª–µ–∫—Å–∏–∫–æ—é —Ç–∞ –±–µ–∑–æ—Å–æ–±–æ–≤–∏–º–∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è–º–∏:",
    "–ê–∫–∞–¥–µ–º—ñ—á–Ω–∏–π": "–°—Ç–≤–æ—Ä–∏ —Ç–µ–∫—Å—Ç –≤ –∞–∫–∞–¥–µ–º—ñ—á–Ω–æ–º—É —Å—Ç–∏–ª—ñ: —Ñ–æ—Ä–º—É–ª—é–π –¥—É–º–∫–∏ –ª–æ–≥—ñ—á–Ω–æ, –æ–±‚Äô—î–∫—Ç–∏–≤–Ω–æ, –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º —Å–∫–ª–∞–¥–Ω–æ–ø—ñ–¥—Ä—è–¥–Ω–∏—Ö —Ä–µ—á–µ–Ω—å —ñ —Ç–µ—Ä–º—ñ–Ω—ñ–≤, –≤–ª–∞—Å—Ç–∏–≤–∏—Ö —Å—Ç—É–¥–µ–Ω—Ç—Å—å–∫–∏–º —ñ –¥–∏–ø–ª–æ–º–Ω–∏–º —Ä–æ–±–æ—Ç–∞–º. –£–Ω–∏–∫–∞–π –µ–º–æ—Ü—ñ–π–Ω–æ—ó –ª–µ–∫—Å–∏–∫–∏.",
    "–§–æ—Ä–º–∞–ª—å–Ω–∏–π": "–ü–æ—è—Å–Ω–∏ —Ü–µ–π —Ç–µ–∫—Å—Ç –ø—Ä–æ—Å—Ç–æ—é, —Ñ–æ—Ä–º–∞–ª—å–Ω–æ—é –º–æ–≤–æ—é:",
    "–ú–æ—Ç–∏–≤–∞—Ü—ñ–π–Ω–∏–π": "–ù–∞–ø–∏—à–∏ —Ü–µ–π —Ç–µ–∫—Å—Ç —è–∫ –º–æ—Ç–∏–≤–∞—Ü—ñ–π–Ω–µ –∑–≤–µ—Ä–Ω–µ–Ω–Ω—è:",
    "–†–æ–∑–ø–æ–≤—ñ–¥—å": "–ù–∞–ø–∏—à–∏ —Ü–µ–π —Ç–µ–∫—Å—Ç —É —Ñ–æ—Ä–º–∞—Ç—ñ –≤–∏–≥–∞–¥–∞–Ω–æ—ó —ñ—Å—Ç–æ—Ä—ñ—ó, —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ –∫–∞–∑–∫–∞ —á–∏ —Ñ–∞–Ω—Ñ—ñ–∫—à–Ω:"
}

user_input = st.text_area("–í–≤–µ–¥—ñ—Ç—å —Å–≤—ñ–π —Ç–µ–∫—Å—Ç:", key="user_text")

if st.button("–ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç", key="generate_button") and user_input:
    full_prompt = f"{prompt_styles[style]} {user_input}"
    with st.spinner("–ì–µ–Ω–µ—Ä—É—î—Ç—å—Å—è..."):
        response = client.chat.completions.create(
            model="gpt-3.5-turbo",
            messages=[
                {"role": "system", "content": "–¢–∏ –ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∏–π –º–æ–≤–Ω–∏–π —Ä–µ–¥–∞–∫—Ç–æ—Ä, —è–∫–∏–π –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î –≤—Ö—ñ–¥–Ω–∏–π —Ç–µ–∫—Å—Ç –Ω–∞ –≥—Ä–∞–º–∞—Ç–∏—á–Ω–æ, –ª–µ–∫—Å–∏—á–Ω–æ —Ç–∞ —Å—Ç–∏–ª—ñ—Å—Ç–∏—á–Ω–æ –±–µ–∑–¥–æ–≥–∞–Ω–Ω–∏–π —É–∫—Ä–∞—ó–Ω—Å—å–∫–∏–π —Ç–µ–∫—Å—Ç —É –∑–∞–¥–∞–Ω–æ–º—É —Å—Ç–∏–ª—ñ. –£–Ω–∏–∫–∞–π —Ä—É—Å–∏–∑–º—ñ–≤, –∫–∞–ª—å–æ–∫ —ñ –Ω–µ—Ç–∏–ø–æ–≤–∏—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü—ñ–π."},
                {"role": "system", "content": "–£—Å—ñ —Ä–µ—á–µ–Ω–Ω—è –º–∞—é—Ç—å –±—É—Ç–∏ –ª–æ–≥—ñ—á–Ω–æ –∑–≤‚Äô—è–∑–∞–Ω—ñ, –ª–µ–∫—Å–∏–∫–∞ ‚Äì –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∞ –¥–æ —Å—Ç–∏–ª—é, –∞ –ø—É–Ω–∫—Ç—É–∞—Ü—ñ—è ‚Äì –∫–æ—Ä–µ–∫—Ç–Ω–æ—é."},
                {"role": "user", "content": full_prompt}
            ],
            max_tokens=1000,
            temperature=0.8
        )
        result = response.choices[0].message.content

        st.download_button("–ó–±–µ—Ä–µ–≥—Ç–∏", result, file_name="zghenerovanyi_tekst.txt", key="copy_button")
        st.subheader("–ó–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π —Ç–µ–∫—Å—Ç:")
        st.text_area("–†–µ–∑—É–ª—å—Ç–∞—Ç", value=result, height=300, key="result_area")
       
elif st.button("–û—á–∏—Å—Ç–∏—Ç–∏", key="clear_button"):
    st.session_state.user_text = ""
    st.experimental_rerun()

elif user_input == "":
    st.warning("–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å —Ç–µ–∫—Å—Ç.")
